<?php

$list = array(
    array(
        'title' => 'Introduction',
        'children' => array(
            array( 'title' => 'Overview' ),
            array(
                'title' => 'Getting Started',
                'children' => array(
                    array( 'title' => 'Minimum Document Requirements' ),
                    array( 'title' => 'Compiler' ),
                    array( 'title' => 'Configuration' ),
                    array( 'title' => 'Using Custom Fonts' )
                )
            ),
            array(
                'title' => 'Scripts',
                'children' => array(
                    array( 'title' => 'Common' ),
                    array( 'title' => 'Components' ),
                    array( 'title' => 'Affix' ),
                    array( 'title' => 'ScrollTo' ),
                    array( 'title' => 'Sticky Header' ),
                    array( 'title' => 'SVG Replace' )
                )
            )
        )
    ),
    array(
        'title' => 'Components',
        'children' => array(
            array( 'title' => 'Alert' ),
            array( 'title' => 'Button Group' ),
            array( 'title' => 'Canvas Panels' ),
            array( 'title' => 'Dropdown' ),
            array( 'title' => 'Embed Responsive' ),
            array( 'title' => 'Form Blocks' ),
            array( 'title' => 'Grid' ),
            array( 'title' => 'Help Block' ),
            array( 'title' => 'Horizontal Form' ),
            array( 'title' => 'Icon' ),
            array( 'title' => 'Icon List' ),
            array( 'title' => 'Inline Form' ),
            array( 'title' => 'Inset Block' ),
            array( 'title' => 'Navicon' ),
            array( 'title' => 'Page' ),
            array( 'title' => 'Page Navigation' ),
            array( 'title' => 'Panel' ),
            array( 'title' => 'Progress Bar' ),
            array( 'title' => 'Search Bar' ),
            array( 'title' => 'Simple Modal' )
        )
    ),
    array(
        'title' => 'Javelin',
        'children' => array(
            array( 'title' => 'Blog' ),
            array( 'title' => 'Calendar' ),
            array( 'title' => 'Carousel' ),
            array( 'title' => 'Contact Form' ),
            array( 'title' => 'FAQ' ),
            array( 'title' => 'Gallery' ),
            array( 'title' => 'Links' ),
            array( 'title' => 'Navigation' ),
            array( 'title' => 'Obituaries' ),
            array( 'title' => 'Products' ),
            array( 'title' => 'Staff' ),
            array( 'title' => 'Tabs' ),
            array( 'title' => 'Twitter' ),
            array( 'title' => 'User Bar' ),
            array( 'title' => 'Weather' )
        )
    ),
    array(
        'title' => 'Helpers',
        'children' => array(
            array( 'title' => 'btn' ),
            array( 'title' => 'btn-default' ),
            array( 'title' => 'btn-inverse' ),
            array( 'title' => 'btn-link' ),
            array( 'title' => 'btn-block' ),
            array( 'title' => 'btn-sm' ),
            array( 'title' => 'btn-lg' ),
            array( 'title' => 'clearfix' ),
            array( 'title' => 'dl-horizontal' ),
            array( 'title' => 'float-left' ),
            array( 'title' => 'float-right' ),
            array( 'title' => 'form-control' ),
            array( 'title' => 'form-control-sm' ),
            array( 'title' => 'form-control-lg' ),
            array( 'title' => 'form-control-static' ),
            array( 'title' => 'form-switch' ),
            array( 'title' => 'form-switch-inline' ),
            array( 'title' => 'hidden-[ breakpoint ]' ),
            array( 'title' => 'hide' ),
            array( 'title' => 'hr-vertical' ),
            array( 'title' => 'img-cover' ),
            array( 'title' => 'img-responsive' ),
            array( 'title' => 'relative' ),
            array( 'title' => 'show' ),
            array( 'title' => 'sr' ),
            array( 'title' => 'static' ),
            array( 'title' => 'table' ),
            array( 'title' => 'table-bordered' ),
            array( 'title' => 'table-striped' ),
            array( 'title' => 'table-condensed' ),
            array( 'title' => 'table-flush' ),
            array( 'title' => 'table-hover' ),
            array( 'title' => 'table-responsive' ),
            array( 'title' => 'text-left' ),
            array( 'title' => 'text-center' ),
            array( 'title' => 'text-right' ),
            array( 'title' => 'text-top' ),
            array( 'title' => 'text-middle' ),
            array( 'title' => 'text-bottom' ),
            array( 'title' => 'visible-[ breakpoint ]' )
        )
    ),
    array(
        'title' => 'Mixins',
        'children' => array(
            array( 'title' => 'alert-color' ),
            array( 'title' => 'bg-cover' ),
            array( 'title' => 'border-box-sizing' ),
            array( 'title' => 'button-color' ),
            array( 'title' => 'button-gradient' ),
            array( 'title' => 'button-size' ),
            array( 'title' => 'clear-columns' ),
            array( 'title' => 'clearfix' ),
            array( 'title' => 'common-blocks' ),
            array( 'title' => 'custom-bold' ),
            array( 'title' => 'custom-italic' ),
            array( 'title' => 'custom-bolditalic' ),
            array( 'title' => 'defer-typekit-styles' ),
            array( 'title' => 'fixed-toolbar' ),
            array( 'title' => 'form-control-size' ),
            array( 'title' => 'form-control-focus' ),
            array( 'title' => 'gradient.horizontal' ),
            array( 'title' => 'gradient.vertical' ),
            array( 'title' => 'gradient.horizontal-three-colors' ),
            array( 'title' => 'gradient.vertical-three-colors' ),
            array( 'title' => 'gradient.horizontal-four-colors' ),
            array( 'title' => 'gradient.vertical-four-colors' ),
            array( 'title' => 'gradient.directional' ),
            array( 'title' => 'gradient.radial' ),
            array( 'title' => 'gradient.striped' ),
            array( 'title' => 'headings' ),
            array( 'title' => 'hr-color' ),
            array( 'title' => 'hr-size' ),
            array( 'title' => 'icon-size' ),
            array( 'title' => 'invisibility' ),
            array( 'title' => 'javelin-custom-bullets' ),
            array( 'title' => 'javelin-custom-bullets-size' ),
            array( 'title' => 'javelin-custom-images' ),
            array( 'title' => 'javelin-fix-module-ui' ),
            array( 'title' => 'javelin-fix-module-item-ui' ),
            array( 'title' => 'javelin-legacy-pager' ),
            array( 'title' => 'javelin-unfloat-images' ),
            array( 'title' => 'javelin-responsive-media' ),
            array( 'title' => 'list-inline' ),
            array( 'title' => 'list-inline-spacing' ),
            array( 'title' => 'list-unstyled' ),
            array( 'title' => 'make-grid-container' ),
            array( 'title' => 'make-grid-row' ),
            array( 'title' => 'make-grid-column-default' ),
            array( 'title' => 'overflow-scroll' ),
            array( 'title' => 'progress-bar-color' ),
            array( 'title' => 'progress-bar-size' ),
            array( 'title' => 'reset-grid-column' ),
            array( 'title' => 'reset-grid-container' ),
            array( 'title' => 'reset-grid-layout' ),
            array( 'title' => 'reset-grid-offset' ),
            array( 'title' => 'reset-grid-pull' ),
            array( 'title' => 'reset-grid-push' ),
            array( 'title' => 'reset-grid-row' ),
            array( 'title' => 'remove-tab-focus' ),
            array( 'title' => 'tab-focus' ),
            array( 'title' => 'text-hide' ),
            array( 'title' => 'text-overflow' ),
            array( 'title' => 'triangle' ),
            array( 'title' => 'visibility' )
        )
    )
);


// Apply paths and permalinks to the list items and return as a json encoded string
$list_pathed = applyPaths($list);
$list_mapped = array_map('applyPermalinks', $list_pathed);

echo json_encode($list_mapped);


// ----------------------------------------------------------------------------------------------------


// Build list to output
function applyPaths($list, $path = '') {
    $len = count($list);
    
    for ($i = 0; $i < $len; $i++) {
        $item = $list[$i];
        
        // For nested items, we include an additional 'path' attribute
        if ($path !== '') {
            $list[$i]['path'] = dasherize($path);
        }
        
        // Recursively apply to nested lists
        if (isset($list[$i]['children'])) {
            $current_path = $path . ($path !== '' ? '/' : '');
            
            $list[$i]['children'] = applyPaths($list[$i]['children'], strtolower($current_path . $list[$i]['title']));
        }
    }
    
    return $list;
}


// Map each item in an array to have its 'title' attribute converted into a 'permalink'
function applyPermalinks($item) {
    // Create a permalink using the title if there isn't one already
    if (!isset($item['permalink'])) {
        // Convert title to a "pretty" format (aka permalink)
        $permalink = strtolower($item['title']);
        $permalink = dasherize($permalink);
        $permalink = preg_replace('/[^a-z0-9-]/i', '', $permalink);
        
        // Set permalink
        $item['permalink'] = $permalink . '.html';
    }
    
    // Recursively operate on nested items
    if (isset($item['children'])) {
        $item['children'] = array_map('applyPermalinks', $item['children']);
    }
    
    return $item;
}


// Convert whitespace characters to dashes
function dasherize($str) {
    return preg_replace('/[\s.]+/', '-', $str);
}

?>